# 出荷証明書Webシステム - システムメモ

## 更新履歴
- 2025-01-30: Webフォームを出荷証明書作成依頼書形式に全面リニューアル

## システム構成
- **フロントエンド**: `/public/index.html` - 出荷証明書作成依頼書フォーム
- **バックエンド**: `/scripts/gas-shipping-form.js` - Google Apps Script連携
- **データベース**: 中央データベース (ID: 1tw3L-PQpr2D4o9GMISCQkfEMfR2aqr8aQtYcsqGptYY)

## 主要機能
1. **受付番号自動生成**: YYYYMMDD-HHMMSS 形式
2. **動的行追加**: 商品最大7件、業者最大3件
3. **フォームバリデーション**: 必須項目・メール形式チェック
4. **管理番号採番**: YYYYMMDD-XXX-1 形式で自動採番

## 今後の検討事項

### 1. 行追加機能の運用方針
- **現状**: 商品7件、業者3件まで対応
- **提案**: 最初は1行表示、必要に応じて「追加」ボタンで拡張
- **検討点**: 
  - 削除時の最小行数制限（現在1行）
  - 上限到達時の処理
  - ユーザビリティ向上案

### 2. データ検証・エラーハンドリング
- **現状**: 基本的なフロント検証のみ
- **改善案**:
  - バックエンドでの重複チェック
  - メールアドレス到達性確認
  - 商品名・会社名のマスタチェック

### 3. セキュリティ強化
- **CORS設定**: 現在no-corsモード
- **入力サニタイズ**: XSS対策
- **レート制限**: 連続送信防止

### 4. ユーザビリティ向上
- **自動保存**: ローカルストレージ活用
- **入力補完**: 過去データからの候補表示
- **プログレス表示**: 送信状況の可視化

### 5. 既存システムとの連携強化
- **AY解決機能**: マスターデータとの自動連携
- **PDF自動生成**: 依頼書PDF生成の自動化
- **メール通知**: 段階的な通知システム

## 技術的メモ

### データマッピング
- A列: チェックボックス
- B列: 管理番号
- C列: 申請日時
- D列: ステータス（申請中）
- E列: 版数
- F-M列: 基本情報
- N-S列: 業者情報（3業者×2列）
- T-AJ列: 商品情報（7商品×4列）

### 設定値
- `SPREADSHEET_ID`: '1tw3L-PQpr2D4o9GMISCQkfEMfR2aqr8aQtYcsqGptYY'
- `SHEET_NAME`: 'シート1'
- `GOOGLE_SCRIPT_URL`: 要設定

### 注意点
- Google Apps Scriptは30秒制限あり
- no-corsモードのため応答確認不可
- 大量データ送信時のタイムアウト対応必要